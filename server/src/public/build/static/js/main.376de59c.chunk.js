(this["webpackJsonpcorp-messaging"]=this["webpackJsonpcorp-messaging"]||[]).push([[0],{81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var c=n(43),s=n.n(c),a=n(2),i=n(3),r=n(19),o=n(5),l=n(4),u=n(1),j=n.n(u),d=n(15),b=n.n(d),h=n(21),m={isAuthorized:!1,currentPage:parseInt(localStorage.getItem("currentPage")||"0")},O=Object(h.b)({name:"state",initialState:m,reducers:{togglePage:function(e,t){e.currentPage=t.payload,localStorage.setItem("currentPage",e.currentPage.toString())},authorization:function(e,t){null!==t.payload?(localStorage.setItem("yoga",t.payload),e.isAuthorized=!0):(localStorage.removeItem("yoga"),e.isAuthorized=!1)}}}),p=O.reducer,x=O.actions,v=x.togglePage,g=x.authorization,f=Object(h.a)({reducer:{globalState:p}}),N=Object(d.io)("http://localhost:5000/auth",{transports:["websocket"],secure:!0}),S=b()("http://localhost:5000/users",{transports:["websocket"],secure:!0,autoConnect:!0,auth:{token:localStorage.getItem("yoga")}});N.on("connect_error",(function(e){console.log("authSocket:",e)})),S.on("connect_error",(function(e){console.log("userSocket:",e)})),N.on("auth: sign-in",(function(e){200===e.status?(f.dispatch(g(e.token)),f.dispatch(v(6)),S.auth={token:localStorage.getItem("yoga")},setTimeout((function(){return S.connect()}),1e3)):console.log("authSocket:",e.msg)})),N.on("auth: check-token",(function(e){200===e.status?(f.dispatch(g(localStorage.getItem("yoga"))),S.connect()):(console.log(e.msg),f.dispatch(g(null)),S.disconnect())}));var y=function(){S.disconnect(),f.dispatch(g(null)),f.dispatch(v(0))},k=n(12),C=n.n(k),w=n(0),I=new Map;I.set(0,{id:0,name:"home"}),I.set(1,{id:1,name:"sign-in",view:"Sign in",icon:Object(w.jsx)("i",{className:"fas fa-sign-in-alt icon"})}),I.set(2,{id:2,name:"contacts",view:"Contacts",icon:Object(w.jsx)("span",{className:"material-icons icon",children:"group"})}),I.set(3,{id:3,name:"chat",view:"Messages",icon:Object(w.jsx)("span",{className:"fas fa-comments icon"})}),I.set(6,{id:6,name:"Profile",view:"Profile",icon:Object(w.jsx)("span",{className:"material-icons icon",children:"account_box"})}),I.set(4,{id:4,name:"groups"}),I.set(5,{id:5,name:"feed",view:"Feed",icon:Object(w.jsx)("span",{className:"material-icons icon",children:"article"})});var P=I,_=[[1],[3,6]],E=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=f.getState().globalState;return Object(w.jsx)("nav",{children:Object(w.jsx)("ul",{className:"zero",children:_[e.isAuthorized?1:0].map((function(t){var n=P.get(t),c=C()({current:t===e.currentPage});return Object(w.jsx)("li",{children:Object(w.jsxs)("button",{className:c,onClick:function(){return f.dispatch(v(t))},children:[(null===n||void 0===n?void 0:n.icon)||"",Object(w.jsx)("span",{className:"text",children:null===n||void 0===n?void 0:n.view})]})},null===n||void 0===n?void 0:n.name)}))})})}}]),n}(u.Component),A=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("header",{children:Object(w.jsxs)("div",{className:"contaner",children:[Object(w.jsx)("div",{onClick:T,className:"title",children:Object(w.jsx)("h1",{children:"Corporate messaging"})}),Object(w.jsx)(E,{})]})})}}]),n}(u.Component);function T(){f.getState().globalState.isAuthorized||f.dispatch(v(0))}var R=n(22),U=n.p+"static/media/user.2f28dce2.png",z=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("div",{className:"chat-image",children:[Object(w.jsx)("img",{src:this.props.picSrc||U,alt:"user"}),this.props.hideOnlineIcon?Object(w.jsx)(w.Fragment,{}):Object(w.jsx)(q,{online:this.props.online||!1})]})}}]),n}(u.Component);function q(e){return Object(w.jsx)("div",{className:"online-indicator",children:Object(w.jsx)("div",{className:C()({online:e.online,offline:!e.online})})})}var D=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=void 0===this.props.showInfo||this.props.showInfo;return Object(w.jsxs)("article",{className:C()({message:!0,self:this.props.self}),children:[e?Object(w.jsx)(z,{hideOnlineIcon:!0,picSrc:this.props.picSrc||void 0}):Object(w.jsx)(w.Fragment,{}),Object(w.jsxs)("div",{className:"message-box",children:[e?Object(w.jsx)("div",{className:"name",children:this.props.userName}):Object(w.jsx)(w.Fragment,{}),Object(w.jsx)("div",{className:"text",children:this.props.text}),Object(w.jsx)("div",{className:"time",children:this.props.time})]})]})}}]),n}(u.Component),F=n(44),M=n(27),B="newChatMessage",L=function(e){var t=Object(u.useState)([]),n=Object(R.a)(t,2),c=n[0],s=n[1],a=Object(u.useRef)();Object(u.useEffect)((function(){return a.current=b()("http://localhost:5000",{query:{roomId:e},secure:!0}),a.current.on(B,(function(e){var t,n=Object(M.a)(Object(M.a)({},e),{},{ownedByCurrentUser:e.senderId===(null===(t=a.current)||void 0===t?void 0:t.id)});s((function(e){return[].concat(Object(F.a)(e),[n])}))})),function(){var e;null===(e=a.current)||void 0===e||e.disconnect()}}),[e]);return{messages:c,sendMessage:function(e){var t;""!==e.trim()&&(null===(t=a.current)||void 0===t||t.emit(B,{text:e,senderId:a.current.id}))}}};function K(e){return Object(w.jsx)("section",{className:"chat-profile",children:Object(w.jsxs)("article",{children:[Object(w.jsx)("button",{className:"back",children:Object(w.jsx)("i",{className:"fas fa-arrow-left"})}),Object(w.jsx)(z,{hideOnlineIcon:!0,picSrc:e.picSrc}),Object(w.jsxs)("div",{className:"title",children:[Object(w.jsx)("div",{className:"name",children:e.name}),Object(w.jsx)("div",{className:"info",children:e.info})]}),Object(w.jsx)("button",{className:"more",children:Object(w.jsx)("i",{className:"fas fa-ellipsis-v"})})]})})}function W(){var e=L("0000"),t=e.messages,n=e.sendMessage,c=j.a.useState(""),s=Object(R.a)(c,2),a=s[0],i=s[1],r=function(){n(a),i("")};return Object(w.jsxs)("div",{className:"page chat-area",children:[Object(w.jsx)(K,{name:"room 0000",info:""}),Object(w.jsx)("section",{className:"chat-output",children:t.map((function(e){return Object(w.jsx)(D,{userName:e.name||"Somebody",text:e.text,time:(new Date).toTimeString().substring(0,5),picSrc:e.picSrc,showInfo:!0,self:e.ownedByCurrentUser})}))}),Object(w.jsx)("section",{className:"chat-input",children:Object(w.jsx)("article",{className:"input",children:Object(w.jsxs)("div",{className:"input-contaner chat-input",children:[Object(w.jsx)("button",{children:Object(w.jsx)("span",{className:"material-icons",children:"attach_file"})}),Object(w.jsx)("textarea",{value:a,onChange:function(e){i(e.target.value)},placeholder:"Enter your message",onKeyUp:function(e){13===e.keyCode&&r()}}),Object(w.jsx)("button",{onClick:r,children:Object(w.jsx)("span",{className:"material-icons",children:"send"})})]})})})]})}var H=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{className:"page coming-soon",children:Object(w.jsx)("div",{children:"Coming soon..."})})}}]),n}(u.Component),J=n.p+"static/media/home1.38963afa.jpg",V=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{className:"page home",children:Object(w.jsxs)("section",{className:"header",children:[Object(w.jsxs)("article",{className:"title",children:[Object(w.jsx)("h1",{children:"Corporate messaging"}),Object(w.jsx)("div",{children:"Business at hand"}),Object(w.jsx)("button",{onClick:function(){return f.dispatch(v(1))},children:"Get started..."})]}),Object(w.jsxs)("article",{className:"buttons",children:[Object(w.jsxs)("div",{className:"col1",children:[Object(w.jsx)("p",{children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Sed dolore maxime eius qui, assumenda mollitia necessitatibus harum accusamus commodi nobis quas ullam nihil molestias vel ducimus cupiditate a asperiores reprehenderit."}),Object(w.jsx)("p",{children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Fugiat asperiores iusto ex amet dolore rerum sit quibusdam quod velit voluptatem distinctio eligendi eos culpa dolorum itaque maxime minus numquam inventore officiis sed perspiciatis adipisci, eveniet laudantium. Aperiam reprehenderit incidunt blanditiis."})]}),Object(w.jsx)("div",{className:"col2",children:Object(w.jsx)("div",{className:"photo-wrapper",children:Object(w.jsx)("img",{src:J,alt:""})})})]})]})})}}]),n}(u.Component),G=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("div",{className:"page profile",children:[Object(w.jsx)("section",{className:"header",children:Object(w.jsx)("article",{})}),Object(w.jsx)("section",{className:"info",children:Object(w.jsx)("article",{})}),Object(w.jsx)("section",{className:"actions",children:Object(w.jsx)("article",{children:Object(w.jsx)("button",{onClick:y,children:"Sign out"})})})]})}}]),n}(u.Component),Q=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var c;return Object(a.a)(this,n),(c=t.call(this,e)).state={username:"",password:""},c}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(w.jsx)("div",{className:"page sign-in",children:Object(w.jsx)("section",{children:Object(w.jsxs)("article",{children:[Object(w.jsx)("div",{className:"input-wrapper",children:Object(w.jsx)("input",{type:"text",placeholder:"Username",onChange:function(t){return e.setState({username:t.target.value})}})}),Object(w.jsx)("div",{className:"input-wrapper",children:Object(w.jsx)("input",{type:"password",placeholder:"Password",onChange:function(t){return e.setState({password:t.target.value})}})}),Object(w.jsx)("button",{onClick:function(){var t,n;t=e.state.username,n=e.state.password,N.emit("auth: sign-in",{username:t,password:n})},children:"Sign in"})]})})})}}]),n}(u.Component),X=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){switch(f.getState().globalState.currentPage){case 0:return Object(w.jsx)(Y,{children:Object(w.jsx)(V,{})});case 1:return Object(w.jsx)(Y,{children:Object(w.jsx)(Q,{})});case 3:return Object(w.jsx)(Y,{children:Object(w.jsx)(W,{})});case 6:return Object(w.jsx)(Y,{children:Object(w.jsx)(G,{})});default:return Object(w.jsx)(Y,{children:Object(w.jsx)(H,{})})}}}]),n}(u.Component);function Y(e){return Object(w.jsx)("main",{children:Object(w.jsx)("div",{className:"contaner",children:e.children})})}console.log(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SERVER_URL:"http://localhost:5000"}));var Z=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var c;return Object(a.a)(this,n),(c=t.call(this,e)).state={version:0},c.rerender=c.rerender.bind(Object(r.a)(c)),c}return Object(i.a)(n,[{key:"unscribe",value:function(){}},{key:"rerender",value:function(){this.setState({version:this.state.version+1})}},{key:"componentDidMount",value:function(){this.unscribe=f.subscribe(this.rerender),function(){var e=localStorage.getItem("yoga");e&&N.emit("auth: check-token",{token:e})}()}},{key:"componentWillUnmount",value:function(){this.unscribe()}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){return Object(w.jsxs)("div",{children:[Object(w.jsx)(A,{}),Object(w.jsx)(X,{})]})}}]),n}(u.Component);n(81);s.a.render(Object(w.jsx)(Z,{}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.376de59c.chunk.js.map